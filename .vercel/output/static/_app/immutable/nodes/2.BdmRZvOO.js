import"../chunks/CWj6FrbW.js";import"../chunks/DM_Ne0bn.js";import{q as ve,r as A,v as fe,T as d,ai as ue,F as ce,H as de,G as z,I as Q,J as K,C as H,a9 as _e,ad as he,z as F,M as me,L as O,aj as we,K as be,ak as q,al as W,ag as re,i as pe,am as ge,N as se,O as ye,an as Ee,ao as Ne,ap as P,B as te,ab as Ae,aq as Te,a2 as Ie,ar as Se,a5 as Me,as as xe,at as Ce,au as ke,av as De,j as Le,aw as Oe,ax as Re,Y as Z,Z as X,a as V,a1 as D,$ as T,a0 as I,ay as C}from"../chunks/DdrfwqFx.js";import{a as He,l as qe,e as j,s as $,r as Ye}from"../chunks/BGEziH-Z.js";import{i as Ke}from"../chunks/BnVknx0g.js";function Pe(e,r){return r}function Ve(e,r,a){for(var s=e.items,n=[],v=r.length,o=0;o<v;o++)Te(r[o].e,n,!0);var c=v>0&&n.length===0&&a!==null;if(c){var _=a.parentNode;Ie(_),_.append(a),s.clear(),S(e,r[0].prev,r[v-1].next)}Se(n,()=>{for(var y=0;y<v;y++){var m=r[y];c||(s.delete(m.k),S(e,m.prev,m.next)),te(m.e,!c)}})}function $e(e,r,a,s,n,v=null){var o=e,c={flags:r,items:new Map,first:null};A&&fe();var _=null,y=!1,m=new Map,M=ue(()=>{var i=a();return pe(i)?i:i==null?[]:re(i)}),l,w;function f(){Be(w,l,c,m,o,n,r,s,a),v!==null&&(l.length===0?_?se(_):_=F(()=>v(o)):_!==null&&ye(_,()=>{_=null}))}ve(()=>{w??(w=Me),l=d(M);var i=l.length;if(y&&i===0)return;y=i===0;let b=!1;if(A){var N=ce(o)===de;N!==(i===0)&&(o=z(),Q(o),K(!1),b=!0)}if(A){for(var p=null,u,t=0;t<i;t++){if(H.nodeType===_e&&H.data===he){o=H,b=!0,K(!1);break}var h=l[t],g=s(h,t);u=G(H,c,p,null,h,g,t,n,r,a),c.items.set(g,u),p=u}i>0&&Q(z())}if(A)i===0&&v&&(_=F(()=>v(o)));else if(me()){var k=new Set,x=O;for(t=0;t<i;t+=1){h=l[t],g=s(h,t);var E=c.items.get(g)??m.get(g);E?ne(E,h,t):(u=G(null,c,null,null,h,g,t,n,r,a,!0),m.set(g,u)),k.add(g)}for(const[L,R]of c.items)k.has(L)||x.skipped_effects.add(R.e);x.add_callback(f)}else f();b&&K(!0),d(M)}),A&&(o=H)}function Be(e,r,a,s,n,v,o,c,_){var y=r.length,m=a.items,M=a.first,l=M,w,f=null,i=[],b=[],N,p,u,t;for(t=0;t<y;t+=1){if(N=r[t],p=c(N,t),u=m.get(p),u===void 0){var h=s.get(p);if(h!==void 0){s.delete(p),m.set(p,h);var g=f?f.next:l;S(a,f,h),S(a,h,g),B(h,g,n),f=h}else{var k=l?l.e.nodes_start:n;f=G(k,a,f,f===null?a.first:f.next,N,p,t,v,o,_)}m.set(p,f),i=[],b=[],l=f.next;continue}if(ne(u,N,t),u.e.f&P&&se(u.e),u!==l){if(w!==void 0&&w.has(u)){if(i.length<b.length){var x=b[0],E;f=x.prev;var L=i[0],R=i[i.length-1];for(E=0;E<i.length;E+=1)B(i[E],x,n);for(E=0;E<b.length;E+=1)w.delete(b[E]);S(a,L.prev,R.next),S(a,f,L),S(a,R,x),l=x,f=R,t-=1,i=[],b=[]}else w.delete(u),B(u,l,n),S(a,u.prev,u.next),S(a,u,f===null?a.first:f.next),S(a,f,u),f=u;continue}for(i=[],b=[];l!==null&&l.k!==p;)l.e.f&P||(w??(w=new Set)).add(l),b.push(l),l=l.next;if(l===null)continue;u=l}i.push(u),f=u,l=u.next}if(l!==null||w!==void 0){for(var Y=w===void 0?[]:re(w);l!==null;)l.e.f&P||Y.push(l),l=l.next;var le=Y.length;if(le>0){var ie=null;Ve(a,Y,ie)}}e.first=a.first&&a.first.e,e.last=f&&f.e;for(var oe of s.values())te(oe.e);s.clear()}function ne(e,r,a,s){we(e.v,r),e.i=a}function G(e,r,a,s,n,v,o,c,_,y,m){var M=(_&Ee)!==0,l=(_&Ne)===0,w=M?l?q(n,!1,!1):W(n):n,f=_&ge?W(o):o,i={i:f,v:w,k:v,a:null,e:null,prev:a,next:s};try{if(e===null){var b=document.createDocumentFragment();b.append(e=be())}return i.e=F(()=>c(e,w,f,y),A),i.e.prev=a&&a.e,i.e.next=s&&s.e,a===null?m||(r.first=i):(a.next=i,a.e.next=i.e),s!==null&&(s.prev=i,s.e.prev=i.e),i}finally{}}function B(e,r,a){for(var s=e.next?e.next.e.nodes_start:a,n=r?r.e.nodes_start:a,v=e.e.nodes_start;v!==null&&v!==s;){var o=Ae(v);n.before(v),v=o}}function S(e,r,a){r===null?e.first=a:(r.next=a,r.e.next=a&&a.e),a!==null&&(a.prev=r,a.e.prev=r&&r.e)}function Je(e,r,a){var s=e==null?"":""+e;return s=s?s+" "+r:r,s===""?null:s}function Ue(e,r,a,s,n,v){var o=e.__className;if(A||o!==a||o===void 0){var c=Je(a,s);(!A||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):e.className=c),e.__className=a}return v}const Fe=Symbol("is custom element"),Ge=Symbol("is html");function Ze(e){if(A){var r=!1,a=()=>{if(!r){if(r=!0,e.hasAttribute("value")){var s=e.value;ee(e,"value",null),e.value=s}if(e.hasAttribute("checked")){var n=e.checked;ee(e,"checked",null),e.checked=n}}};e.__on_r=a,xe(a),He()}}function ee(e,r,a,s){var n=ze(e);A&&(n[r]=e.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&e.nodeName==="LINK")||n[r]!==(n[r]=a)&&(r==="loading"&&(e[Ce]=a),e.removeAttribute(r))}function ze(e){return e.__attributes??(e.__attributes={[Fe]:e.nodeName.includes("-"),[Ge]:e.namespaceURI===ke})}function ae(e,r,a=r){var s=De(),n=new WeakSet;qe(e,"input",v=>{var o=v?e.defaultValue:e.value;if(o=J(e)?U(o):o,a(o),O!==null&&n.add(O),s&&o!==(o=r())){var c=e.selectionStart,_=e.selectionEnd;e.value=o??"",_!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(_,e.value.length))}}),(A&&e.defaultValue!==e.value||Le(r)==null&&e.value)&&(a(J(e)?U(e.value):e.value),O!==null&&n.add(O)),Oe(()=>{var v=r();if(e===document.activeElement){var o=Re??O;if(n.has(o))return}J(e)&&v===U(e.value)||e.type==="date"&&!v&&!e.value||v!==e.value&&(e.value=v??"")})}function J(e){var r=e.type;return r==="number"||r==="range"}function U(e){return e===""?null:+e}var Qe=Z('<div><strong class="svelte-1nwowsb"> </strong> <p class="svelte-1nwowsb"> </p></div>'),We=Z('<div class="message assistant svelte-1nwowsb"><strong class="svelte-1nwowsb">AI:</strong> <p class="svelte-1nwowsb">Thinking...</p></div>'),Xe=Z('<main><div class="container svelte-1nwowsb"><h1 class="svelte-1nwowsb">Zoho CRM AI Assistant</h1> <div class="search-input svelte-1nwowsb"><label for="searchName" class="svelte-1nwowsb">Lead Name, Deal Name, or Company:</label> <input id="searchName" type="text" placeholder="Enter Lead Name, Deal Name, or Company (e.g., John Doe, Q4 Sales Deal, Acme Corp)" class="svelte-1nwowsb"/></div> <div class="chat-container svelte-1nwowsb"><div class="chat-history svelte-1nwowsb"><!> <!></div> <div class="input-container svelte-1nwowsb"><textarea placeholder="Ask a question about your CRM data..." class="svelte-1nwowsb"></textarea> <button class="svelte-1nwowsb"> </button></div></div></div></main>');function ta(e){let r=q(""),a=q(""),s=q([]),n=q(!1);async function v(){if(!d(r).trim()||!d(a).trim()){alert("Please enter both a message and search name");return}C(n,!0),C(s,[...d(s),{role:"user",content:d(r)}]);try{const h=await(await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:d(r),searchName:d(a)})})).json();h.response?C(s,[...d(s),{role:"assistant",content:h.response}]):C(s,[...d(s),{role:"assistant",content:"Sorry, I encountered an error."}])}catch(t){console.error("Error sending message:",t),C(s,[...d(s),{role:"assistant",content:"Sorry, I encountered an error."}])}C(r,""),C(n,!1)}function o(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),v())}var c=Xe(),_=T(c),y=D(T(_),2),m=D(T(y),2);Ze(m),I(y);var M=D(y,2),l=T(M),w=T(l);$e(w,1,()=>d(s),Pe,(t,h)=>{var g=Qe(),k=T(g),x=T(k);I(k);var E=D(k,2),L=T(E,!0);I(E),I(g),X(()=>{Ue(g,1,`message ${d(h).role??""}`,"svelte-1nwowsb"),$(x,`${d(h).role==="user"?"You":"AI"}:`),$(L,d(h).content)}),V(t,g)});var f=D(w,2);{var i=t=>{var h=We();V(t,h)};Ke(f,t=>{d(n)&&t(i)})}I(l);var b=D(l,2),N=T(b);Ye(N);var p=D(N,2),u=T(p);I(p),I(b),I(M),I(_),I(c),X(t=>{N.disabled=d(n),p.disabled=t,$(u,`${d(n)?"⏳":"📤"} Send`)},[()=>d(n)||!d(r).trim()||!d(a).trim()]),ae(m,()=>d(a),t=>C(a,t)),ae(N,()=>d(r),t=>C(r,t)),j("keypress",N,o),j("click",p,v),V(e,c)}export{ta as component};
